{"remainingRequest":"/home/stevenbustos/Downloads/SIUA/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/stevenbustos/Downloads/SIUA/frontend/src/components/requests/create/CreateRequestB.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/stevenbustos/Downloads/SIUA/frontend/src/components/requests/create/CreateRequestB.vue","mtime":1548796958000},{"path":"/home/stevenbustos/Downloads/SIUA/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/stevenbustos/Downloads/SIUA/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/stevenbustos/Downloads/SIUA/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/stevenbustos/Downloads/SIUA/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Multiselect from 'vue-multiselect'\nimport {axios,requestModulePermit,requestIdModulePermit,putModulePermit,verifyPermits} from '../../../helpers/axios';\nimport { required } from 'vuelidate/lib/validators'\nvar API_IP = process.env.VUE_APP_API_IP\n\nexport default {\n  props: ['stp','object'],\n  components: {\n    Multiselect\n  },\n  data () {\n    return {\n      numMod:\"\",\n      permitAll:[0,1,2,3,4],\n      justification: '',\n      aditional_justification:'',\n      general_objective:'',\n      place:'',\n      cities: [],\n      permitsRequest:[],\n      step: this.stp,\n      obj:this.object,\n      request_type: \"\",\n      submitting: false,\n      no_aditional_justification: true\n    }\n  },\n  validations: {\n    justification: {required},\n    general_objective: {required}, place: {required},\n  },\n  mounted () {\n    this.loadData()\n    this.aditionalJustificationStatus()\n  },\n  methods:{\n    async loadData(){\n      let tipo = await requestIdModulePermit(205,1,this.obj.tipo_solicitud)\n      if (tipo.nombre === \"ODS\") {\n        this.numMod = 9\n        this.permitsRequest=await verifyPermits(9,this.permitAll)\n      }\n      else if (tipo.nombre === \"ODC\") {\n        this.numMod = 10\n        this.permitsRequest=await verifyPermits(10,this.permitAll)\n      }\n      else if (tipo.nombre === \"ATI\") {\n        this.numMod = 11\n        this.permitsRequest=await verifyPermits(11,this.permitAll)\n      }\n      this.cities = await requestModulePermit(201,0)\n    },\n    aditionalJustificationStatus(){\n      var curYear = new Date();\n      var endYear = new Date();\n      var yyyy = curYear.getFullYear();\n      curYear = yyyy;\n      endYear = this.obj.fecha_final.substring(0,4);\n      if ( endYear > curYear ){\n        this.no_aditional_justification = false\n      } else {\n        this.no_aditional_justification = true\n      }\n    },\n    async saveContinue(){\n      this.$v.$touch()\n      if (this.$v.$invalid) {\n        this.$swal({\n          title: 'Error!',\n          text: 'Debe llenar campos necesarios en el formulario',\n          type: 'error',\n          confirmButtonText: 'Cerrar'\n        });\n      } else {\n        if (this.permitsRequest[3]) {\n          this.submitting = true;\n          let data={\n            auditoria:this.obj.auditoria,\n            clausulas:this.obj.clausulas,\n            estado:this.obj.estado,\n            _id:this.obj._id,\n            numero_solicitud:this.obj.numero_solicitud,\n            tipo_solicitud:this.obj.tipo_solicitud,\n            fecha_inicio:this.obj.fecha_inicio,\n            fecha_final:this.obj.fecha_final,\n            valor_solicitud:this.obj.valor_solicitud,\n            justificacion:this.justification,\n            justificacion_adicional:this.aditional_justification,\n            objetivo_general:this.general_objective,\n            especificaciones_tecnicas:this.obj.especificaciones_tecnicas,\n            obligaciones_especificas:this.obj.obligaciones_especificas,\n            rubros:this.obj.rubros,\n            trabajadores:this.obj.trabajadores,\n            ciudad:this.place\n          }\n\n          let res = await putModulePermit(this.numMod,3,this.obj._id,data)\n          if (res != undefined && res != null){\n            if (res.res) {\n              this.$swal({\n                title: 'Exito!',\n                text: 'Se actualizo la solicitud con exito.',\n                type: 'success',\n                confirmButtonText: 'Aceptar'\n              }).then((result) => {\n                if (result.value) {\n                  this.$emit('saveObject',res);\n                  this.submitting = false;\n                  this.step++\n                  this.$emit('nextStep', this.step)\n                }\n              });\n            }\n            else if (res.error) {\n              this.$swal({\n                 title: 'Error!',\n                 text: res.error.error.msg,\n                 type: 'error',\n                 confirmButtonText: 'Cerrar'\n               });\n               this.submitting = false;\n            }\n          }\n\n        }\n      }\n    },\n    cancel(){\n      this.$v.$reset()\n      this.$swal({\n        title: 'Espere',\n        text: '¿Esta seguro que quiere cancelar la operación?',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Cancelado',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'requests' });\n            }\n          });\n        }\n      });\n    },\n    previous(){\n      this.$swal({\n        title: 'Espere',\n        html: '¿Esta seguro que quiere volver?<br>Los cambios hechos aqui no se guardaran.',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Volviendo',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'updaterequest', params: { type: this.request_type.toLowerCase() ,id: this.obj._id } });\n            }\n          });\n        }\n      });\n    }\n  }\n}\n",{"version":3,"sources":["CreateRequestB.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CreateRequestB.vue","sourceRoot":"src/components/requests/create","sourcesContent":["<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col-md-8 offset-md-2\" style=\"margin-bottom:50px;\">\n        <div class=\"row\">\n          <div class=\"col\">\n            <button class=\"btn btn-primary\" type=\"button\" @click=\"previous()\" style=\"background:#003e1e;border-color:#003e1e;\">\n              <font-awesome-icon icon=\"arrow-left\" size=\"lg\"></font-awesome-icon>\n            </button>\n          </div>\n        </div>\n        <div>&nbsp;</div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-10 align-self-center\">\n            <form v-on:submit.prevent=\"saveContinue\" novalidate>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.justification.$error }\">\n                <label for=\"justification\">Justificación:</label>\n                <textarea v-model.trim=\"$v.justification.$model\" class=\"form-control\" aria-label=\"justification\"\n                placeholder=\"Justificación\" :rows=\"6\" :max-rows=\"10\"></textarea>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.justification.$dirty && !$v.justification.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div class=\"form-group\">\n                <label for=\"aditionalJustification\">Justificación adicional:</label>\n                <textarea v-model=\"aditional_justification\" class=\"form-control\" :disabled=\"no_aditional_justification\" aria-label=\"aditionalJustification\"\n                placeholder=\"Justificación adicional\" :rows=\"6\" :max-rows=\"10\"></textarea>\n              </div>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.general_objective.$error }\">\n                <label for=\"generalObjective\">Objetivo general de la contratación requerida:</label>\n                <textarea v-model.trim=\"$v.general_objective.$model\" class=\"form-control\" aria-label=\"generalObjective\"\n                placeholder=\"Objetivo general\" :rows=\"6\" :max-rows=\"10\"></textarea>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.general_objective.$dirty && !$v.general_objective.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.place.$error }\">\n                <label for=\"place\">Lugar de ejecución o de entrega:</label>\n                <multiselect id=\"box2\" v-model.trim=\"$v.place.$model\" :options=\"cities\"  :searchable=\"false\" :close-on-select=\"true\" :show-labels=\"true\" label=\"nombre\" placeholder=\"Escoja un lugar\">\n                </multiselect>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.place.$dirty && !$v.place.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div>&nbsp;</div>\n              <div class=\"row justify-content-center\">\n                <div class=\"col-8 align-self-center\">\n                  <div class=\"row justify-content-center\">\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" type=\"button\" @click=\"cancel()\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"times-circle\" size=\"lg\"></font-awesome-icon>\n                        Cancelar\n                      </button>\n                    </div>\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" type=\"button\" @click=\"previous()\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"arrow-left\" size=\"lg\"></font-awesome-icon>\n                        Anterior\n                      </button>\n                    </div>\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" :disabled=\"submitting\" type=\"submit\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"save\" size=\"lg\"></font-awesome-icon>\n                        Guardar y continuar\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Multiselect from 'vue-multiselect'\nimport {axios,requestModulePermit,requestIdModulePermit,putModulePermit,verifyPermits} from '../../../helpers/axios';\nimport { required } from 'vuelidate/lib/validators'\nvar API_IP = process.env.VUE_APP_API_IP\n\nexport default {\n  props: ['stp','object'],\n  components: {\n    Multiselect\n  },\n  data () {\n    return {\n      numMod:\"\",\n      permitAll:[0,1,2,3,4],\n      justification: '',\n      aditional_justification:'',\n      general_objective:'',\n      place:'',\n      cities: [],\n      permitsRequest:[],\n      step: this.stp,\n      obj:this.object,\n      request_type: \"\",\n      submitting: false,\n      no_aditional_justification: true\n    }\n  },\n  validations: {\n    justification: {required},\n    general_objective: {required}, place: {required},\n  },\n  mounted () {\n    this.loadData()\n    this.aditionalJustificationStatus()\n  },\n  methods:{\n    async loadData(){\n      let tipo = await requestIdModulePermit(205,1,this.obj.tipo_solicitud)\n      if (tipo.nombre === \"ODS\") {\n        this.numMod = 9\n        this.permitsRequest=await verifyPermits(9,this.permitAll)\n      }\n      else if (tipo.nombre === \"ODC\") {\n        this.numMod = 10\n        this.permitsRequest=await verifyPermits(10,this.permitAll)\n      }\n      else if (tipo.nombre === \"ATI\") {\n        this.numMod = 11\n        this.permitsRequest=await verifyPermits(11,this.permitAll)\n      }\n      this.cities = await requestModulePermit(201,0)\n    },\n    aditionalJustificationStatus(){\n      var curYear = new Date();\n      var endYear = new Date();\n      var yyyy = curYear.getFullYear();\n      curYear = yyyy;\n      endYear = this.obj.fecha_final.substring(0,4);\n      if ( endYear > curYear ){\n        this.no_aditional_justification = false\n      } else {\n        this.no_aditional_justification = true\n      }\n    },\n    async saveContinue(){\n      this.$v.$touch()\n      if (this.$v.$invalid) {\n        this.$swal({\n          title: 'Error!',\n          text: 'Debe llenar campos necesarios en el formulario',\n          type: 'error',\n          confirmButtonText: 'Cerrar'\n        });\n      } else {\n        if (this.permitsRequest[3]) {\n          this.submitting = true;\n          let data={\n            auditoria:this.obj.auditoria,\n            clausulas:this.obj.clausulas,\n            estado:this.obj.estado,\n            _id:this.obj._id,\n            numero_solicitud:this.obj.numero_solicitud,\n            tipo_solicitud:this.obj.tipo_solicitud,\n            fecha_inicio:this.obj.fecha_inicio,\n            fecha_final:this.obj.fecha_final,\n            valor_solicitud:this.obj.valor_solicitud,\n            justificacion:this.justification,\n            justificacion_adicional:this.aditional_justification,\n            objetivo_general:this.general_objective,\n            especificaciones_tecnicas:this.obj.especificaciones_tecnicas,\n            obligaciones_especificas:this.obj.obligaciones_especificas,\n            rubros:this.obj.rubros,\n            trabajadores:this.obj.trabajadores,\n            ciudad:this.place\n          }\n\n          let res = await putModulePermit(this.numMod,3,this.obj._id,data)\n          if (res != undefined && res != null){\n            if (res.res) {\n              this.$swal({\n                title: 'Exito!',\n                text: 'Se actualizo la solicitud con exito.',\n                type: 'success',\n                confirmButtonText: 'Aceptar'\n              }).then((result) => {\n                if (result.value) {\n                  this.$emit('saveObject',res);\n                  this.submitting = false;\n                  this.step++\n                  this.$emit('nextStep', this.step)\n                }\n              });\n            }\n            else if (res.error) {\n              this.$swal({\n                 title: 'Error!',\n                 text: res.error.error.msg,\n                 type: 'error',\n                 confirmButtonText: 'Cerrar'\n               });\n               this.submitting = false;\n            }\n          }\n\n        }\n      }\n    },\n    cancel(){\n      this.$v.$reset()\n      this.$swal({\n        title: 'Espere',\n        text: '¿Esta seguro que quiere cancelar la operación?',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Cancelado',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'requests' });\n            }\n          });\n        }\n      });\n    },\n    previous(){\n      this.$swal({\n        title: 'Espere',\n        html: '¿Esta seguro que quiere volver?<br>Los cambios hechos aqui no se guardaran.',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Volviendo',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'updaterequest', params: { type: this.request_type.toLowerCase() ,id: this.obj._id } });\n            }\n          });\n        }\n      });\n    }\n  }\n}\n</script>\n"]}]}