{"remainingRequest":"/home/developer/Documents/SIUA/frontend/node_modules/babel-loader/lib/index.js!/home/developer/Documents/SIUA/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/developer/Documents/SIUA/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/developer/Documents/SIUA/frontend/src/components/requests/create/CreateRequestB.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/developer/Documents/SIUA/frontend/src/components/requests/create/CreateRequestB.vue","mtime":1548796958733},{"path":"/home/developer/Documents/SIUA/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/developer/Documents/SIUA/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/developer/Documents/SIUA/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/developer/Documents/SIUA/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/developer/Documents/SIUA/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Multiselect from 'vue-multiselect';\nimport { axios, requestModulePermit, requestIdModulePermit, putModulePermit, verifyPermits } from '../../../helpers/axios';\nimport { required } from 'vuelidate/lib/validators';\nvar API_IP = process.env.VUE_APP_API_IP;\nexport default {\n  props: ['stp', 'object'],\n  components: {\n    Multiselect: Multiselect\n  },\n  data: function data() {\n    return {\n      numMod: \"\",\n      permitAll: [0, 1, 2, 3, 4],\n      justification: '',\n      aditional_justification: '',\n      general_objective: '',\n      place: '',\n      cities: [],\n      permitsRequest: [],\n      step: this.stp,\n      obj: this.object,\n      request_type: \"\",\n      submitting: false,\n      no_aditional_justification: true\n    };\n  },\n  validations: {\n    justification: {\n      required: required\n    },\n    general_objective: {\n      required: required\n    },\n    place: {\n      required: required\n    }\n  },\n  mounted: function mounted() {\n    this.loadData();\n    this.aditionalJustificationStatus();\n  },\n  methods: {\n    loadData: function () {\n      var _loadData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var tipo;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return requestIdModulePermit(205, 1, this.obj.tipo_solicitud);\n\n              case 2:\n                tipo = _context.sent;\n\n                if (!(tipo.nombre === \"ODS\")) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.numMod = 9;\n                _context.next = 7;\n                return verifyPermits(9, this.permitAll);\n\n              case 7:\n                this.permitsRequest = _context.sent;\n                _context.next = 22;\n                break;\n\n              case 10:\n                if (!(tipo.nombre === \"ODC\")) {\n                  _context.next = 17;\n                  break;\n                }\n\n                this.numMod = 10;\n                _context.next = 14;\n                return verifyPermits(10, this.permitAll);\n\n              case 14:\n                this.permitsRequest = _context.sent;\n                _context.next = 22;\n                break;\n\n              case 17:\n                if (!(tipo.nombre === \"ATI\")) {\n                  _context.next = 22;\n                  break;\n                }\n\n                this.numMod = 11;\n                _context.next = 21;\n                return verifyPermits(11, this.permitAll);\n\n              case 21:\n                this.permitsRequest = _context.sent;\n\n              case 22:\n                _context.next = 24;\n                return requestModulePermit(201, 0);\n\n              case 24:\n                this.cities = _context.sent;\n\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function loadData() {\n        return _loadData.apply(this, arguments);\n      }\n\n      return loadData;\n    }(),\n    aditionalJustificationStatus: function aditionalJustificationStatus() {\n      var curYear = new Date();\n      var endYear = new Date();\n      var yyyy = curYear.getFullYear();\n      curYear = yyyy;\n      endYear = this.obj.fecha_final.substring(0, 4);\n\n      if (endYear > curYear) {\n        this.no_aditional_justification = false;\n      } else {\n        this.no_aditional_justification = true;\n      }\n    },\n    saveContinue: function () {\n      var _saveContinue = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this = this;\n\n        var data, res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.$v.$touch();\n\n                if (!this.$v.$invalid) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                this.$swal({\n                  title: 'Error!',\n                  text: 'Debe llenar campos necesarios en el formulario',\n                  type: 'error',\n                  confirmButtonText: 'Cerrar'\n                });\n                _context2.next = 12;\n                break;\n\n              case 5:\n                if (!this.permitsRequest[3]) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                this.submitting = true;\n                data = {\n                  auditoria: this.obj.auditoria,\n                  clausulas: this.obj.clausulas,\n                  estado: this.obj.estado,\n                  _id: this.obj._id,\n                  numero_solicitud: this.obj.numero_solicitud,\n                  tipo_solicitud: this.obj.tipo_solicitud,\n                  fecha_inicio: this.obj.fecha_inicio,\n                  fecha_final: this.obj.fecha_final,\n                  valor_solicitud: this.obj.valor_solicitud,\n                  justificacion: this.justification,\n                  justificacion_adicional: this.aditional_justification,\n                  objetivo_general: this.general_objective,\n                  especificaciones_tecnicas: this.obj.especificaciones_tecnicas,\n                  obligaciones_especificas: this.obj.obligaciones_especificas,\n                  rubros: this.obj.rubros,\n                  trabajadores: this.obj.trabajadores,\n                  ciudad: this.place\n                };\n                _context2.next = 10;\n                return putModulePermit(this.numMod, 3, this.obj._id, data);\n\n              case 10:\n                res = _context2.sent;\n\n                if (res != undefined && res != null) {\n                  if (res.res) {\n                    this.$swal({\n                      title: 'Exito!',\n                      text: 'Se actualizo la solicitud con exito.',\n                      type: 'success',\n                      confirmButtonText: 'Aceptar'\n                    }).then(function (result) {\n                      if (result.value) {\n                        _this.$emit('saveObject', res);\n\n                        _this.submitting = false;\n                        _this.step++;\n\n                        _this.$emit('nextStep', _this.step);\n                      }\n                    });\n                  } else if (res.error) {\n                    this.$swal({\n                      title: 'Error!',\n                      text: res.error.error.msg,\n                      type: 'error',\n                      confirmButtonText: 'Cerrar'\n                    });\n                    this.submitting = false;\n                  }\n                }\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function saveContinue() {\n        return _saveContinue.apply(this, arguments);\n      }\n\n      return saveContinue;\n    }(),\n    cancel: function cancel() {\n      var _this2 = this;\n\n      this.$v.$reset();\n      this.$swal({\n        title: 'Espere',\n        text: '¿Esta seguro que quiere cancelar la operación?',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No'\n      }).then(function (result) {\n        if (result.value) {\n          _this2.$swal({\n            title: 'Cancelado',\n            type: 'success'\n          }).then(function (result) {\n            if (result.value) {\n              _this2.$router.push({\n                name: 'requests'\n              });\n            }\n          });\n        }\n      });\n    },\n    previous: function previous() {\n      var _this3 = this;\n\n      this.$swal({\n        title: 'Espere',\n        html: '¿Esta seguro que quiere volver?<br>Los cambios hechos aqui no se guardaran.',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No'\n      }).then(function (result) {\n        if (result.value) {\n          _this3.$swal({\n            title: 'Volviendo',\n            type: 'success'\n          }).then(function (result) {\n            if (result.value) {\n              _this3.$router.push({\n                name: 'updaterequest',\n                params: {\n                  type: _this3.request_type.toLowerCase(),\n                  id: _this3.obj._id\n                }\n              });\n            }\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["CreateRequestB.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col-md-8 offset-md-2\" style=\"margin-bottom:50px;\">\n        <div class=\"row\">\n          <div class=\"col\">\n            <button class=\"btn btn-primary\" type=\"button\" @click=\"previous()\" style=\"background:#003e1e;border-color:#003e1e;\">\n              <font-awesome-icon icon=\"arrow-left\" size=\"lg\"></font-awesome-icon>\n            </button>\n          </div>\n        </div>\n        <div>&nbsp;</div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-10 align-self-center\">\n            <form v-on:submit.prevent=\"saveContinue\" novalidate>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.justification.$error }\">\n                <label for=\"justification\">Justificación:</label>\n                <textarea v-model.trim=\"$v.justification.$model\" class=\"form-control\" aria-label=\"justification\"\n                placeholder=\"Justificación\" :rows=\"6\" :max-rows=\"10\"></textarea>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.justification.$dirty && !$v.justification.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div class=\"form-group\">\n                <label for=\"aditionalJustification\">Justificación adicional:</label>\n                <textarea v-model=\"aditional_justification\" class=\"form-control\" :disabled=\"no_aditional_justification\" aria-label=\"aditionalJustification\"\n                placeholder=\"Justificación adicional\" :rows=\"6\" :max-rows=\"10\"></textarea>\n              </div>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.general_objective.$error }\">\n                <label for=\"generalObjective\">Objetivo general de la contratación requerida:</label>\n                <textarea v-model.trim=\"$v.general_objective.$model\" class=\"form-control\" aria-label=\"generalObjective\"\n                placeholder=\"Objetivo general\" :rows=\"6\" :max-rows=\"10\"></textarea>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.general_objective.$dirty && !$v.general_objective.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div class=\"form-group\" :class=\"{ 'form-group--error': $v.place.$error }\">\n                <label for=\"place\">Lugar de ejecución o de entrega:</label>\n                <multiselect id=\"box2\" v-model.trim=\"$v.place.$model\" :options=\"cities\"  :searchable=\"false\" :close-on-select=\"true\" :show-labels=\"true\" label=\"nombre\" placeholder=\"Escoja un lugar\">\n                </multiselect>\n                <div class=\"alert alert-danger\" role=\"alert\" v-if=\"$v.place.$dirty && !$v.place.required\">Es requerida una fecha de inicio</div>\n              </div>\n              <div>&nbsp;</div>\n              <div class=\"row justify-content-center\">\n                <div class=\"col-8 align-self-center\">\n                  <div class=\"row justify-content-center\">\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" type=\"button\" @click=\"cancel()\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"times-circle\" size=\"lg\"></font-awesome-icon>\n                        Cancelar\n                      </button>\n                    </div>\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" type=\"button\" @click=\"previous()\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"arrow-left\" size=\"lg\"></font-awesome-icon>\n                        Anterior\n                      </button>\n                    </div>\n                    <div class=\"col-3 text-center\">\n                      <button class=\"btn btn-primary\" :disabled=\"submitting\" type=\"submit\" style=\"background:#003e1e;border-color:#003e1e;\">\n                        <font-awesome-icon icon=\"save\" size=\"lg\"></font-awesome-icon>\n                        Guardar y continuar\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Multiselect from 'vue-multiselect'\nimport {axios,requestModulePermit,requestIdModulePermit,putModulePermit,verifyPermits} from '../../../helpers/axios';\nimport { required } from 'vuelidate/lib/validators'\nvar API_IP = process.env.VUE_APP_API_IP\n\nexport default {\n  props: ['stp','object'],\n  components: {\n    Multiselect\n  },\n  data () {\n    return {\n      numMod:\"\",\n      permitAll:[0,1,2,3,4],\n      justification: '',\n      aditional_justification:'',\n      general_objective:'',\n      place:'',\n      cities: [],\n      permitsRequest:[],\n      step: this.stp,\n      obj:this.object,\n      request_type: \"\",\n      submitting: false,\n      no_aditional_justification: true\n    }\n  },\n  validations: {\n    justification: {required},\n    general_objective: {required}, place: {required},\n  },\n  mounted () {\n    this.loadData()\n    this.aditionalJustificationStatus()\n  },\n  methods:{\n    async loadData(){\n      let tipo = await requestIdModulePermit(205,1,this.obj.tipo_solicitud)\n      if (tipo.nombre === \"ODS\") {\n        this.numMod = 9\n        this.permitsRequest=await verifyPermits(9,this.permitAll)\n      }\n      else if (tipo.nombre === \"ODC\") {\n        this.numMod = 10\n        this.permitsRequest=await verifyPermits(10,this.permitAll)\n      }\n      else if (tipo.nombre === \"ATI\") {\n        this.numMod = 11\n        this.permitsRequest=await verifyPermits(11,this.permitAll)\n      }\n      this.cities = await requestModulePermit(201,0)\n    },\n    aditionalJustificationStatus(){\n      var curYear = new Date();\n      var endYear = new Date();\n      var yyyy = curYear.getFullYear();\n      curYear = yyyy;\n      endYear = this.obj.fecha_final.substring(0,4);\n      if ( endYear > curYear ){\n        this.no_aditional_justification = false\n      } else {\n        this.no_aditional_justification = true\n      }\n    },\n    async saveContinue(){\n      this.$v.$touch()\n      if (this.$v.$invalid) {\n        this.$swal({\n          title: 'Error!',\n          text: 'Debe llenar campos necesarios en el formulario',\n          type: 'error',\n          confirmButtonText: 'Cerrar'\n        });\n      } else {\n        if (this.permitsRequest[3]) {\n          this.submitting = true;\n          let data={\n            auditoria:this.obj.auditoria,\n            clausulas:this.obj.clausulas,\n            estado:this.obj.estado,\n            _id:this.obj._id,\n            numero_solicitud:this.obj.numero_solicitud,\n            tipo_solicitud:this.obj.tipo_solicitud,\n            fecha_inicio:this.obj.fecha_inicio,\n            fecha_final:this.obj.fecha_final,\n            valor_solicitud:this.obj.valor_solicitud,\n            justificacion:this.justification,\n            justificacion_adicional:this.aditional_justification,\n            objetivo_general:this.general_objective,\n            especificaciones_tecnicas:this.obj.especificaciones_tecnicas,\n            obligaciones_especificas:this.obj.obligaciones_especificas,\n            rubros:this.obj.rubros,\n            trabajadores:this.obj.trabajadores,\n            ciudad:this.place\n          }\n\n          let res = await putModulePermit(this.numMod,3,this.obj._id,data)\n          if (res != undefined && res != null){\n            if (res.res) {\n              this.$swal({\n                title: 'Exito!',\n                text: 'Se actualizo la solicitud con exito.',\n                type: 'success',\n                confirmButtonText: 'Aceptar'\n              }).then((result) => {\n                if (result.value) {\n                  this.$emit('saveObject',res);\n                  this.submitting = false;\n                  this.step++\n                  this.$emit('nextStep', this.step)\n                }\n              });\n            }\n            else if (res.error) {\n              this.$swal({\n                 title: 'Error!',\n                 text: res.error.error.msg,\n                 type: 'error',\n                 confirmButtonText: 'Cerrar'\n               });\n               this.submitting = false;\n            }\n          }\n\n        }\n      }\n    },\n    cancel(){\n      this.$v.$reset()\n      this.$swal({\n        title: 'Espere',\n        text: '¿Esta seguro que quiere cancelar la operación?',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Cancelado',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'requests' });\n            }\n          });\n        }\n      });\n    },\n    previous(){\n      this.$swal({\n        title: 'Espere',\n        html: '¿Esta seguro que quiere volver?<br>Los cambios hechos aqui no se guardaran.',\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Si',\n        cancelButtonText: 'No',\n      }).then((result) => {\n        if (result.value) {\n          this.$swal({\n            title: 'Volviendo',\n            type: 'success'\n          }).then((result) => {\n            if (result.value) {\n              this.$router.push({ name: 'updaterequest', params: { type: this.request_type.toLowerCase() ,id: this.obj._id } });\n            }\n          });\n        }\n      });\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/components/requests/create"}]}